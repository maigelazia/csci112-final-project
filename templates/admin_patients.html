{% extends "admin_base.html" %}

{% block title %}Patients{% endblock %}

{% block content %}
<h2>Patients</h2>
<div id="table-container"></div>
{% endblock %}

{% block scripts %}
<script>
async function fetchAndRender(url) {
    const res = await fetch(url);
    const data = await res.json();

    const container = document.getElementById('table-container');

    if (!data || data.length === 0) {
        container.innerHTML = "<p>No patients found.</p>";
        return;
    }

    // Create table headers
    const headers = Object.keys(data[0]);
    let table = "<table class='admin-table'><tr>";
    headers.forEach(h => table += `<th>${h}</th>`);
    table += "</tr>";

    // Fill table rows
    data.forEach(row => {
        table += "<tr>";
        headers.forEach(h => table += `<td>${row[h]}</td>`);
        table += "</tr>";
    });

    table += "</table>";
    container.innerHTML = table;
}

// Fetch patients on page load
fetchAndRender('/api/admin/patients');
</script>
{% endblock %}
